{"paragraphs":[{"text":"%md \n### Let's make sure Spark is working first!\nLet's see what version we are working with.","user":"anonymous","dateUpdated":"2021-01-18T20:49:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h3>Let's make sure Spark is working first!</h3>\n<p>Let's see what version we are working with.</p>\n"}]},"apps":[],"jobName":"paragraph_1611002867085_391619436","id":"20210118-204747_35026850","dateCreated":"2021-01-18T20:47:47+0000","dateStarted":"2021-01-18T20:49:26+0000","dateFinished":"2021-01-18T20:49:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:10950"},{"text":"sc.version","user":"anonymous","dateUpdated":"2021-01-18T20:50:08+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: String = 2.3.0.2.6.5.0-292\n"}]},"apps":[],"jobName":"paragraph_1611002966268_57427528","id":"20210118-204926_498048979","dateCreated":"2021-01-18T20:49:26+0000","dateStarted":"2021-01-18T20:50:13+0000","dateFinished":"2021-01-18T20:51:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10951"},{"text":"%sh\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.data -O /tmp/u.data\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.item -O /tmp/u.item","user":"anonymous","dateUpdated":"2021-01-18T20:53:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2021-01-18 20:53:38--  http://media.sundog-soft.com/hadoop/ml-100k/u.data\nResolving media.sundog-soft.com (media.sundog-soft.com)... 52.216.164.19\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|52.216.164.19|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 2079229 (2.0M) [application/octet-stream]\nSaving to: ‘/tmp/u.data’\n\n     0K .......... .......... .......... .......... ..........  2%  152K 13s\n    50K .......... .......... .......... .......... ..........  4%  952K 7s\n   100K .......... .......... .......... .......... ..........  7%  453K 6s\n   150K .......... .......... .......... .......... ..........  9% 18.4M 5s\n   200K .......... .......... .......... .......... .......... 12%  310K 5s\n   250K .......... .......... .......... .......... .......... 14% 25.5M 4s\n   300K .......... .......... .......... .......... .......... 17%  321K 4s\n   350K .......... .......... .......... .......... .......... 19% 6.79M 3s\n   400K .......... .......... .......... .......... .......... 22% 25.6M 3s\n   450K .......... .......... .......... .......... .......... 24% 59.7M 3s\n   500K .......... .......... .......... .......... .......... 27% 24.4M 2s\n   550K .......... .......... .......... .......... .......... 29% 1.37M 2s\n   600K .......... .......... .......... .......... .......... 32%  420K 2s\n   650K .......... .......... .......... .......... .......... 34% 9.38M 2s\n   700K .......... .......... .......... .......... .......... 36% 31.0M 2s\n   750K .......... .......... .......... .......... .......... 39%  340M 2s\n   800K .......... .......... .......... .......... .......... 41%  467M 1s\n   850K .......... .......... .......... .......... .......... 44% 26.0M 1s\n   900K .......... .......... .......... .......... .......... 46% 24.8M 1s\n   950K .......... .......... .......... .......... .......... 49% 61.1M 1s\n  1000K .......... .......... .......... .......... .......... 51% 78.9M 1s\n  1050K .......... .......... .......... .......... .......... 54%  268M 1s\n  1100K .......... .......... .......... .......... .......... 56%  324K 1s\n  1150K .......... .......... .......... .......... .......... 59%  465M 1s\n  1200K .......... .......... .......... .......... .......... 61% 31.1M 1s\n  1250K .......... .......... .......... .......... .......... 64%  632M 1s\n  1300K .......... .......... .......... .......... .......... 66% 8.92M 1s\n  1350K .......... .......... .......... .......... .......... 68% 63.7M 1s\n  1400K .......... .......... .......... .......... .......... 71% 37.2M 0s\n  1450K .......... .......... .......... .......... .......... 73% 16.3M 0s\n  1500K .......... .......... .......... .......... .......... 76% 11.5M 0s\n  1550K .......... .......... .......... .......... .......... 78%  126M 0s\n  1600K .......... .......... .......... .......... .......... 81% 32.2M 0s\n  1650K .......... .......... .......... .......... .......... 83% 92.4M 0s\n  1700K .......... .......... .......... .......... .......... 86% 63.1M 0s\n  1750K .......... .......... .......... .......... .......... 88% 31.7M 0s\n  1800K .......... .......... .......... .......... .......... 91%  186M 0s\n  1850K .......... .......... .......... .......... .......... 93% 21.0M 0s\n  1900K .......... .......... .......... .......... .......... 96% 24.7M 0s\n  1950K .......... .......... .......... .......... .......... 98% 14.6M 0s\n  2000K .......... .......... ..........                      100% 25.1M=1.2s\n\n2021-01-18 20:53:39 (1.69 MB/s) - ‘/tmp/u.data’ saved [2079229/2079229]\n\n--2021-01-18 20:53:39--  http://media.sundog-soft.com/hadoop/ml-100k/u.item\nResolving media.sundog-soft.com (media.sundog-soft.com)... 52.217.17.140\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|52.217.17.140|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 236344 (231K) [application/octet-stream]\nSaving to: ‘/tmp/u.item’\n\n     0K .......... .......... .......... .......... .......... 21%  145K 1s\n    50K .......... .......... .......... .......... .......... 43%  812K 1s\n   100K .......... .......... .......... .......... .......... 64%  422K 0s\n   150K .......... .......... .......... .......... .......... 86% 10.7M 0s\n   200K .......... .......... ..........                      100%  192K=0.7s\n\n2021-01-18 20:53:41 (335 KB/s) - ‘/tmp/u.item’ saved [236344/236344]\n\n"}]},"apps":[],"jobName":"paragraph_1611003036280_-1174999820","id":"20210118-205036_861955452","dateCreated":"2021-01-18T20:50:36+0000","dateStarted":"2021-01-18T20:53:38+0000","dateFinished":"2021-01-18T20:53:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10952"},{"title":"Copy data to HDFS","text":"%sh\n\nhadoop fs -rm -r -f /tmp/ml-100k\n\nhadoop fs -mkdir /tmp/ml-100k\n\nhadoop fs -put /tmp/u.data /tmp/ml-100k\nhadoop fs -put /tmp/u.item /tmp/ml-100k","user":"anonymous","dateUpdated":"2021-01-18T20:58:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh","editorHide":false,"tableHide":true,"title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h2>Copy data to HDFS</h2>\n<p>%sh</p>\n<p>hadoop fs -rm -r -f /tmp/ml-100k</p>\n<p>hadoop fs -mkdir /tmp/ml-100k</p>\n<p>hadoop fs -put /tmp/u.data /tmp/ml-100k\n<br  />hadoop fs -put /tmp/u.item /tmp/ml-100k</p>\n"}]},"apps":[],"jobName":"paragraph_1611003043507_872249077","id":"20210118-205043_953513365","dateCreated":"2021-01-18T20:50:43+0000","dateStarted":"2021-01-18T20:57:17+0000","dateFinished":"2021-01-18T20:57:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10953"},{"text":"final case class Rating(movieID: Int, rating: Int)\n\nval lines = sc.textFile(\"hdfs:///tmp/ml-100k/u.data\").map(x=> {var fields = x.split(\"\\t\"); Rating(fields(1).toInt, fields(2).toInt)})","user":"anonymous","dateUpdated":"2021-01-18T21:00:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Rating\nlines: org.apache.spark.rdd.RDD[Rating] = MapPartitionsRDD[2] at map at <console>:28\n"}]},"apps":[],"jobName":"paragraph_1611003008845_-167773172","id":"20210118-205008_1177831122","dateCreated":"2021-01-18T20:50:08+0000","dateStarted":"2021-01-18T21:00:39+0000","dateFinished":"2021-01-18T21:00:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10954"},{"text":"import sqlContext.implicits._\nval ratingsDF = lines.toDF()","user":"anonymous","dateUpdated":"2021-01-18T21:01:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import sqlContext.implicits._\nratingsDF: org.apache.spark.sql.DataFrame = [movieID: int, rating: int]\n"}]},"apps":[],"jobName":"paragraph_1611003639293_1226427670","id":"20210118-210039_942998354","dateCreated":"2021-01-18T21:00:39+0000","dateStarted":"2021-01-18T21:01:25+0000","dateFinished":"2021-01-18T21:01:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10955"},{"text":"ratingsDF.printSchema()","user":"anonymous","dateUpdated":"2021-01-18T21:01:38+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- movieID: integer (nullable = false)\n |-- rating: integer (nullable = false)\n\n"}]},"apps":[],"jobName":"paragraph_1611003685055_-2081765966","id":"20210118-210125_1862502396","dateCreated":"2021-01-18T21:01:25+0000","dateStarted":"2021-01-18T21:01:38+0000","dateFinished":"2021-01-18T21:01:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10956"},{"text":"val topMovieIDs = ratingsDF.groupBy(\"movieID\").count().orderBy(desc(\"count\")).cache()\ntopMovieIDs.show(5)","user":"anonymous","dateUpdated":"2021-01-19T12:33:18+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"topMovieIDs: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [movieID: int, count: bigint]\n+-------+-----+\n|movieID|count|\n+-------+-----+\n|     50|  584|\n|    258|  509|\n|    100|  508|\n|    181|  507|\n|    294|  485|\n+-------+-----+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1611006582073_-1637831966","id":"20210118-214942_1753553293","dateCreated":"2021-01-18T21:49:42+0000","dateStarted":"2021-01-19T12:33:18+0000","dateFinished":"2021-01-19T12:33:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10957"},{"text":"ratingsDF.registerTempTable(\"ratings\")","user":"anonymous","dateUpdated":"2021-01-19T12:36:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1611006594190_-971031473","id":"20210118-214954_1571211674","dateCreated":"2021-01-18T21:49:54+0000","dateStarted":"2021-01-19T12:36:56+0000","dateFinished":"2021-01-19T12:36:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10958"},{"text":"%sql\nSELECT rating, count(*) as qtd\nFROM ratings\nGROUP BY rating","user":"anonymous","dateUpdated":"2021-01-19T12:39:52+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"rating\tqtd\n1\t6111\n3\t27145\n5\t21203\n4\t34174\n2\t11370\n"}]},"apps":[],"jobName":"paragraph_1611059723196_-1156019360","id":"20210119-123523_1216413368","dateCreated":"2021-01-19T12:35:23+0000","dateStarted":"2021-01-19T12:39:34+0000","dateFinished":"2021-01-19T12:39:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10959"},{"text":"final case class Movie(movieID: Int, title: String)\n\nval lines = sc.textFile(\"hdfs:///tmp/ml-100k/u.item\").map(x => {val fields = x.split('|'); Movie(fields(0).toInt, fields(1))})\n\nimport sqlContext.implicits._\nval moviesDF = lines.toDF()\nmoviesDF.show(5)","user":"anonymous","dateUpdated":"2021-01-19T12:42:27+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Movie\nlines: org.apache.spark.rdd.RDD[Movie] = MapPartitionsRDD[74] at map at <console>:33\nimport sqlContext.implicits._\nmoviesDF: org.apache.spark.sql.DataFrame = [movieID: int, title: string]\n+-------+-----------------+\n|movieID|            title|\n+-------+-----------------+\n|      1| Toy Story (1995)|\n|      2| GoldenEye (1995)|\n|      3|Four Rooms (1995)|\n|      4|Get Shorty (1995)|\n|      5|   Copycat (1995)|\n+-------+-----------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1611059839994_-1500168766","id":"20210119-123719_805534974","dateCreated":"2021-01-19T12:37:19+0000","dateStarted":"2021-01-19T12:42:27+0000","dateFinished":"2021-01-19T12:42:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10960"},{"text":"moviesDF.registerTempTable(\"movies\")","user":"anonymous","dateUpdated":"2021-01-19T12:42:51+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n"}]},"apps":[],"jobName":"paragraph_1611060147387_-850298870","id":"20210119-124227_1542847693","dateCreated":"2021-01-19T12:42:27+0000","dateStarted":"2021-01-19T12:42:51+0000","dateFinished":"2021-01-19T12:42:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10961"},{"text":"%sql\nSELECT m.title, avg(r.rating) as avgRating\nFROM ratings r \n    INNER JOIN movies m on r.movieID = m.movieID\nGROUP BY m.title\nHAVING COUNT(*) > 5\nORDER BY avgRating DESC\nLIMIT 5","user":"anonymous","dateUpdated":"2021-01-19T12:45:10+0000","config":{"colWidth":12,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"title\tavgRating\nPather Panchali (1955)\t4.625\nClose Shave, A (1995)\t4.491071428571429\nSchindler's List (1993)\t4.466442953020135\nWrong Trousers, The (1993)\t4.466101694915254\nCasablanca (1942)\t4.45679012345679\n"}]},"apps":[],"jobName":"paragraph_1611060171610_1703526411","id":"20210119-124251_444605474","dateCreated":"2021-01-19T12:42:51+0000","dateStarted":"2021-01-19T12:44:46+0000","dateFinished":"2021-01-19T12:44:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:10962"},{"text":"%sql\n","user":"anonymous","dateUpdated":"2021-01-19T12:44:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1611060246009_-2020214651","id":"20210119-124406_305442109","dateCreated":"2021-01-19T12:44:06+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:10963"}],"name":"First Zeppelin Notebook - Playing with movielens","id":"2FUJPRKV9","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}